#define BUF BASE_SZ
#define GECOS 2
#define LOGIN (BASE_SZ + 2)/GECOS

#include "../../../../../lib/stubs.h"

int
main (void)
{
  // these were parameters
  char login[LOGIN + 1];
  char gecos[GECOS + 1];

  char buf[BUF + 1];
  char c;
  int i, j;

#ifdef __FRAMAC__
  // login must be initialized to avoid UB
  Frama_C_make_unknown(login, sizeof login - 1);
#endif
  login[(int) (sizeof login - 1)] = EOS;
#ifdef __FRAMAC__
  // gecos must be initialized to avoid UB
  Frama_C_make_unknown(gecos, sizeof gecos - 1);
#endif
  gecos[(int) (sizeof gecos - 1)] = EOS;

  i = 0;
  if (gecos[i] == '*')
    i++;

  c = gecos[i];
  j = 0;
  while (c != EOS && c != ',' && c != ';' && c != '%')
  {
    if (c == '&')
    {
      /* BAD */
      (void) strcpy (buf + j, login);
      while (buf[j] != EOS)
	j++;
    }
    else
    {
      /* BAD */
      buf[j] = c;
      j++;
    }	    
    i++;
    c = gecos[i];
  }
  buf[j] = EOS;
  return 0;
}
