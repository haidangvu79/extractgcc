#include "../../../../../lib/stubs.h"
#include "../../../../../lib/base.h"

#define MAXLINE BASE_SZ

int main (void)
{
  char fbuf[MAXLINE+1];
#ifdef __FRAMAC__
  // fbuf must be initialized to avoid UB
  Frama_C_make_unknown(fbuf, MAXLINE);
#endif
  char *fbufp;
  int c1;

  fbufp = fbuf;

  while ((c1 = nondet_unsigned_char ()) != EOF)
  {
    if (isascii (c1) && isspace (c1))
      continue;
    if (c1 == '=')
      continue;

    /* BAD */
    *fbufp = c1;

    /* BAD */
    if (*fbufp++ == '\n')
    {
      if (fbufp <= fbuf)
	fbufp = fbuf;
      else if (*--fbufp != '\r') 
	fbufp++;

      /* BAD */
      *fbufp = EOS;
      fbufp = fbuf;
    }
  }

  /* force out partial last line */
  if (fbufp > fbuf)
  {
    /* BAD */
    *fbufp = EOS;
  }

  return 0;
}
