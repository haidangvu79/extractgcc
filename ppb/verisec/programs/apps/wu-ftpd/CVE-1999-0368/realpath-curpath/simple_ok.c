#include "../wu-ftpd.h"

/* Allocated size of buffer pathname[] in main () */
#define PATHNAME_SZ MAXPATHLEN+1

char *
realpath(const char *pathname, char *result, char* chroot_path)
{
  char curpath[MAXPATHLEN];

  if (result == NULL)
    return(NULL);

  if(pathname == NULL){
    *result = EOS; 
    return(NULL);
  }

  /* OK */
  r_strncpy(curpath, pathname, MAXPATHLEN);

  return result;
}

int main ()
{
  char pathname [PATHNAME_SZ];
  char result [MAXPATHLEN];
  char chroot_path [MAXPATHLEN];

#ifdef __FRAMAC__
  // pathname must be initialized to avoid UB
  Frama_C_make_unknown(pathname, PATHNAME_SZ-1);
#endif
  pathname [PATHNAME_SZ-1] = EOS;
#ifdef __FRAMAC__
  // result must be initialized to avoid UB
  Frama_C_make_unknown(result, MAXPATHLEN-1);
#endif
  result [MAXPATHLEN-1] = EOS;
#ifdef __FRAMAC__
  // chroot_path must be initialized to avoid UB
  Frama_C_make_unknown(chroot_path, MAXPATHLEN-1);
#endif
  chroot_path [MAXPATHLEN-1] = EOS;

  realpath(pathname, result, chroot_path);

  return 0;
}
