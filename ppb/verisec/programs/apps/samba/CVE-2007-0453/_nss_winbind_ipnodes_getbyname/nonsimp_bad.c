#include "../structs.h"

char in [INSZ];

static NSS_STATUS
_nss_winbind_ipnodes_getbyname(void *args)
{
  nss_XbyY_args_t *argp = (nss_XbyY_args_t*) args;
  struct winbindd_request request;

  /* BAD */
  r_strncpy(request.data.winsreq, argp->key.name, strlen(argp->key.name)) ;

  return 0;
}

int main ()
{
  nss_XbyY_args_t k;

#ifdef __FRAMAC__
  // in must be initialized to non-zero values, otherwise there is no bug
  Frama_C_make_unknown(in, INSZ);
#endif
  // Fixed typo: original code wrote to in[INSZ]; also, if the string is
  // nul-terminated, there is no bug, so we remove the assignment
  //in[INSZ-1] = EOS;
  k.key.name = in;

  _nss_winbind_ipnodes_getbyname(&k);

  return 0;
}

