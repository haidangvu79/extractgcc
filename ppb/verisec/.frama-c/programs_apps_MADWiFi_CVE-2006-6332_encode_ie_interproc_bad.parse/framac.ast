/* Generated by Frama-C */
#include "__fc_builtin.h"
#include "assert.h"
#include "ctype.h"
#include "errno.h"
#include "stdarg.h"
#include "stddef.h"
#include "stdio.h"
#include "string.h"
#include "strings.h"
typedef unsigned int u_int;
typedef unsigned char u_int8_t;
struct ieee80211_scan_entry {
   u_int8_t *se_rsn_ie ;
};
static u_int encode_ie(void *buf, size_t bufsize, u_int8_t const *ie,
                       size_t ielen, char const *leader, size_t leader_len)
{
  u_int __retres;
  u_int8_t *p;
  int i;
  long tmp;
  if (bufsize < leader_len) {
    __retres = (u_int)0;
    goto return_label;
  }
  p = (u_int8_t *)buf;
  memcpy((void *)p,(void const *)leader,leader_len);
  bufsize -= leader_len;
  p += leader_len;
  i = 0;
  while (1) {
    if ((size_t)i < ielen) {
      if (! (bufsize > (size_t)2)) break;
    }
    else break;
    *p = (u_int8_t)'x';
    *(p + 1) = (u_int8_t)'x';
    p += 2;
    i ++;
  }
  if ((size_t)i == ielen) tmp = p - (u_int8_t *)buf; else tmp = (long)0;
  __retres = (u_int)tmp;
  return_label: return __retres;
}

static int giwscan_cb(struct ieee80211_scan_entry const *se)
{
  int __retres;
  u_int8_t buf[(2 + 1) + 2];
  char rsn_leader[1];
  if (se->se_rsn_ie != (u_int8_t *)0) 
    if ((int)*(se->se_rsn_ie + 0) == 200) encode_ie((void *)(buf),
                                                    sizeof(buf),
                                                    (u_int8_t const *)se->se_rsn_ie,
                                                    (size_t)((int)*(se->se_rsn_ie + 1) + 2),
                                                    (char const *)(rsn_leader),
                                                    sizeof(rsn_leader) - (unsigned long)1);
  __retres = 0;
  return __retres;
}

int main(void)
{
  int __retres;
  struct ieee80211_scan_entry se;
  u_int8_t ie[(((2 + 1) + 2) - 1) + 5];
  se.se_rsn_ie = ie;
  Frama_C_make_unknown((char *)(ie),(size_t)((((2 + 1) + 2) - 1) + 5));
  *(se.se_rsn_ie + 1) = (u_int8_t)(((((2 + 1) + 2) - 1) + 5) - 2);
  giwscan_cb((struct ieee80211_scan_entry const *)(& se));
  __retres = 0;
  return __retres;
}


